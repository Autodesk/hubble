## Hubble Enterprise Web Dashboard

This web application is built as a [Jekyll](https://jekyllrb.com/) site and is intended to be hosted using [GitHub Pages](https://pages.github.com/).

### Charts

Each `.html` page in this directory contains one or more charts.
Each chart is defined as an `<svg>` element with a few special attributes that define their behavior:

1. `data-url`: a `.tsv` file generated by the [updater](../updater/README.md) (URL to the data file to be rendered by the chart)
1. `class`: the kind of chart that will be rendered (`chart`, `table`, or `collaboration`)
1. `data-type`: the subtype of a chart (`history` or `list`, only applicable if `class` is set to `chart`)

For details on how each kind of chart is rendered, take a look at [`charts.js`](assets/js/charts.js).

### Development

To run the site locally, install [Jekyll](https://jekyllrb.com/).
Then, change the `_config.yml` file and set the `dataURL` to `http://127.0.0.1:4000/demo-data`.
Finally, run `jekyll serve` and load `http://127.0.0.1:4000` in your browser.

#### Tests

This web application uses [Karma](https://karma-runner.github.io) as a test runner (a way to run JavaScript in different browser contexts) and [Jasmine](https://jasmine.github.io) as the testing and assertion library.
The tests are implemented as `.js` files inside the [`spec/`](spec/) folder and mirror the filenames of JavaScript source files.

#### Requirements

- Install a recent version of [node.js](https://nodejs.org).
- Install a recent version of [Google Chrome](https://www.google.com/chrome/), a headless instance of which is used to run the tests.
- Install any needed dependencies by running `npm install` from this folder.

#### Running the Tests

To run the tests and linter:

```sh
npm test
```

To run just the unit tests once:

```sh
npm run unit-test
```

During local development, it may be nice to keep the test runner running in the background as one makes changes to the JavaScript source files (under [`assets/js/`](assets/js)) or the test files (under [`spec/`](spec/)) so as to get immediate feedback.
This mode will rerun the tests every time a source or test file changes.
To run in this mode:

```sh
npm run unit-test -- --no-single-run --auto-watch
```

#### Linting JavaScript

This project has formalized a JavaScript style using [ESLint](https://eslint.org).
To run the linter, ensure you have dependencies installed via `npm install`, then run:

```sh
npm run lint
```

ESLint allows for [cascading rules](https://eslint.org/docs/user-guide/configuring#configuration-cascading-and-hierarchy) to be in place, which this project leverages:

- There is one global ESLint config defined in [`.eslintrc.json`](.eslintrc.json), where we house the main stylistic rules.
- We also have a browser-context-specific config defined in [`assets/js/.eslintrc.json`](assets/js/.eslintrc.json).
- Finally, we have a test-context-specific config defined in [`spec/.eslintrc.json`](spec/.eslintrc.json).

[`.eslintignore`](.eslintignore) defines what directories and files should not be linted.
